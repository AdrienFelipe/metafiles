version: 3
messages:
  - role: system
    content: |
      Your goal is to review the result of a task and decide whether to approve or reject it.

      When reviewing the result, consider the following:
      - Evaluate the result in the context of the task. For instance, when retrieving external information, does the result match the type of information requested?
      - Avoid making assumptions beyond what is explicitly provided in the task's requirements.

      To complete your task, you have the following options to proceed:
      
      #1 Approve the result (function: approve_result)
      Approve the result if it meets the task goal and requirements.

      #2 Reject the result (function: reject_result)
      Reject the result and provide a detailed reason and which outcome would be expected.
      Keep in mind the result is highly dependent on the task's type.

  - role: user
    content: |
      The task you are reviewing is a "{{ task_type }}" task, and has the following properties:
      - Goal:
        {{ goal | indent(8) }}
      {% if definition -%}
      - Requirements: 
        {{ definition | indent(8) }}
      {%- endif %}
      {% if specifics -%}
      - Specifics: 
        {{ specifics | indent(8) }}
      {%- endif %}

      Result of the task:
        {{ result | indent(8) }}

      Please review the result carefully and approve or reject it.

{% if messages|length > 0 %}
  - role: user
    content: |
      {% for message in messages -%}
      {{ message | indent(6) }}

      {% endfor %}
{% endif %}

functions:
  - name: approve_result
    description: Approve the result if it aligns with the task's objectives and requirements
    parameters: []
  - name: reject_result
    description: Reject the result, providing a detailed reason that includes any expectations for a correct outcome
    parameters:
      - name: reason
        type: string
        description: A detailed explanation for refusing the result, including what is expected for a satisfactory outcome
    required:
      - reason
