messages:
  - role: system
    content: |
      Your are an expert task orchestrator for a large language model that solves user tasks.
      Select one of the available actions to best solve the task:
      {% for key, value in actions.items() -%}
      - {{ key }}: {{ value }}
      {% endfor %}
      Consider if the task needs further clarification, requires reasoning, can be executed by code, or should be divided.
      Respond with the chosen action's id and explain your decision.

  - role: user
    content: |
      Task goal: "{{ goal }}"
      {{ definition | indent(6) }}
      {{ specifics | indent(6) }}

      {% if reason -%}
      The reason to choose the action:
      {{ reason | indent(6) }}
      {%- endif %}

functions:
  - name: apply_action
    description: Apply the chosen action
    parameters:
      - name: action_key
        type: string
        description: The key of the chosen action
        enum:
          {% for key in actions.keys() %}
          - {{ key }}
          {% endfor %}
      - name: reason
        type: string
        description: The reason of the choice
    required:
      - action_key
      - reason

callback: apply_action
